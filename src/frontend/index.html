<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="node_modules/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
      type="text/css"
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css"
    />
    <link
      type="text/css"
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css"         
    />

    <link rel="stylesheet" href="css/styles.css" />

    <title>Movie Database</title>
  </head>

  <body></body>
    <div class="wrapper">
      <!-- Sidebar  -->
      <nav id="sidebar">
        <div class="sidebar-header">
          <h3>CS180 KHSP</h3>
        </div>

        <ul class="list-unstyled components">
          <li>
            <a href="analytics.html">Movie Analytics</a>
          </li>
          <li>
            <a href="tabledit.html">Search</a>
          </li>
        </ul>
      </nav>

      <div id="content">
        <header class="jumbotron">
          <div class="container">
            <div class="row row-header">
              <div class="col-12 col-md-6">
                <h1>Movie Analytics</h1>
              </div>
              <div class="col col-md"></div>
            </div>
          </div>
        </header>
    <div id="worstMoviesModal" class="modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Worst Movies</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
  
          <div class="modal-body">
            <select id="yearDropdown1" class="col-md-4">
            </select>
            <button type="button" class="btn btn-primary col-md-4 offset-3" onClick="load3WorstMovies();">GO</button>
            <div id="worstMovieModalList" class="row">
  
            </div>
          </div>
          <div class="modal-footer" >
           
          </div>
        </div>
      </div>
    </div>
  <div id="bestMoviesModal" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Best Movies</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <select id="yearDropdown2" class="col-md-4">
          </select>
          <button type="button" class="btn btn-primary col-md-4 offset-3" onClick="load3BestMovies();">GO</button>
          <div id="bestMovieModalList" class="row">

          </div>
        </div>
        <div class="modal-footer" >
         
        </div>
      </div>
    </div>
  </div>


    <div id="content">
      <header class="ml-5">
        <div class="container  fill movie-banner">
          <!-- <img src="./img/movie_banner.jpg" class="img-fluid" alt="Responsive image"> -->
        </div>
      </header>
      
        <div class="row" >
          <span class="col-md-8">
            <div class="row row-header  mx-auto">
              <div class="card-columns">
              <div
                class="card"
                style="max-width: 36rem;"
              >
                <div class="card-header text-white bg-danger"><h3>Worst Movie of all time</h3></div>
                <div id="wmovie" class="card-body">
                 
                </div>
              </div>
              
              <div
              class="card"
              style="max-width: 36rem;"
            >
              <div class="card-header text-white bg-success"><h3>Best Movie of all time</h3></div>
              <div id="bmovie" class="card-body">
              
              </div>
            </div>

    
              <!-- <div
                class="card  bg-light "
                style="max-width: 36rem;"
              >
                <div class="card-header"><h3>Random Stat</h3></div>
                <div class="card-body">
                  <h5 class="card-title">Success card title</h5>
                  <p class="card-text">
                    Some quick example text to build on the card title and make up
                    the bulk of the card's content.
                  </p>
                </div>
              </div> -->
            </div>
          </div>
            <div class="row row-header">

              <div
              class="card  bg-light mt-3 mb-3"
              >
              <div class="card-header ">
                <h2>Budget vs Revenue</h2> <span class="badge badge-warning">Revenue</span>
                <span class="badge badge-secondary">Budget</span>
              </div>
              <div  class="card-body">
                <div id="d3id" class="ml-6 pl-3"></div>
              </div>
            </div>

            <div
            class="card  bg-light mt-3 mb-3"
            >
            <div class="card-header ">
              <h2>Genre vs Revenue</h2> 
            </div>
            <div  class="card-body">
              <svg width="1200" height="500"></svg>
            </div>
          </div>
            

            </div>
          </span>
          <span class="col-md">
            
            <div
            class="card  bg-light mt-3 mb-3 mr-3"
            >
            <div class="card-header">
              <h2>Flop Movies of 2015</h2>
            </div>
            <div  id="wmovieList" class="card-body">
          
            </div>
          </div>
          </span>
        </div>
        <div class="row" >
          
          <div
          class="card"
          style="max-width: 40rem;"
        >
          <div class="card-header text-white bg-success"><h3>Director Profile: Woody Allen</h3></div>
          <div id="directorGenres" class="card-body">
          
          </div>
        </div>
      
        <div
        class="card ml-3"
        style="max-width: 36rem;"
      >
        <div class="card-header text-white bg-success"><h3>Actor Profile: Chris Pratt</h3></div>
        <div id="actorGenres" class="card-body">
        
        </div>
      </div>
      
      </div>

      <div class="row">
        <div class="card">
         <div class="card-header"><div class="row align-items-center"></dv> <h2>Director Career Trajectory  </h2> <div class="col-12 col-md text-left" id="directorDropDown"></div> </div>  </div>
          <div class="card-body"> <div id="chart" style="width:1200px; height:700px;"></div> 
        </div></div>
        

      </div>

      <div class="row">
        <div class="card">
         <div class="card-header"><div class="row align-items-center"></dv> <h2>Actor Career Trajectory  </h2> <div class="col-12 col-md text-left" id="actorDropDown"></div> </div>  </div>
          <div class="card-body"> <div id="chart1" style="width:1200px; height:700px;"></div> 
        </div></div>
        

      </div>
      
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
        <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
        <script src="js/worstMoviesList.js"></script>
        <script src="js/bestMovies.js"></script>
        <script src="js/budgetVersusRevenue.js"></script>
        <script src="js/singleMovieCards.js"></script>
        <script src="js/bestGenres.js"></script>
        <script src="node_modules/jquery/dist/jquery.slim.min.js"></script>
        <script src="node_modules/popper.js/dist/umd/popper.min.js"></script>
        <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
      
      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"> </script>
    <script src="js/directorLineChart.js"></script>
    <script src="js/actorLineChart.js"></script>

    <script>

    singelMovieCards();
    loadWorstMoviesList();
    loadBudgetVsRevenue();
    loadbestGenres()
    
    for (i = 1999; i <= 2015; i++) {
      $("#yearDropdown1").append(
        "<option value='" + i + '\' href="#">' + i + "</option>"
      );
    }
    for (i = 1999; i <= 2015; i++) {
      $("#yearDropdown2").append(
        "<option value='" + i + '\' href="#">' + i + "</option>"
      );
    }


    var xhr4 = new XMLHttpRequest();
  xhr4.onreadystatechange = function () {
    if (xhr4.readyState == XMLHttpRequest.DONE) {
      
      // {
      //       values: [19, 26, 55],
      //     labels: ['Residential', 'Non-Residential', 'Utility'],
      //     type: 'pie'
      //   }
      var data = [JSON.parse(xhr4.responseText)['data']];

        var layoutDirectorPie = {
          height: 600,
          width: 600
        };

    Plotly.newPlot('directorGenres', data, layoutDirectorPie);
        }
      };
      xhr4.open("GET", "http://localhost:5000/directorGenres?search_director=Woody%20Allen", true);
      xhr4.send();

      var xhr5 = new XMLHttpRequest();
  xhr5.onreadystatechange = function () {
    if (xhr5.readyState == XMLHttpRequest.DONE) {
      
      // {
      //       values: [19, 26, 55],
      //     labels: ['Residential', 'Non-Residential', 'Utility'],
      //     type: 'pie'
      //   }
      var data = [JSON.parse(xhr5.responseText)['data']];

        var layoutActorPie = {
          height: 600,
          width: 600
        };

    Plotly.newPlot('actorGenres', data, layoutActorPie);
        }
      };
      xhr5.open("GET", "http://localhost:5000/actorGenres?search_actor=Chris%20Pratt", true);
      xhr5.send();


////////////////////////////////////Linegraph
    // Visualization API with the Line chart package.
    generateDirector("Woody Allen")
    generateActor("Robert De Niro")


    var s = $("<select id='directorSelector'/>");
    var xhttpA = new XMLHttpRequest();
      xhttpA.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          // Typical action to be performed when the document is ready:
          console.log(xhttpA.responseText)
          data = JSON.parse(xhttpA.responseText)["data"];

          console.log(Object.keys(data));
          for (var val in Object.keys(data)) {
            $("<option />", {
              text: Object.keys(data)[val],
              value: data[Object.keys(data)[val]],
            }).appendTo(s);
          }

          s.appendTo("#directorDropDown");

          $("#directorSelector").change(function () {
            searchField = this.options[this.selectedIndex].text;
            console.log(searchField);
            generateDirector(searchField)
          });
        }
      };
      xhttpA.open("GET", "http://localhost:5000/getTopDirectors", true);
      xhttpA.send();

      ////////////////////// Actor line chart

      
      var s1 = $("<select id='actorSelector'/>");
    var xhttpB = new XMLHttpRequest();
      xhttpB.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          // Typical action to be performed when the document is ready:
          data = JSON.parse(xhttpB.responseText)["data"];

          console.log(Object.keys(data));
          for (var val in Object.keys(data)) {
            $("<option />", {
              text: Object.keys(data)[val],
              value: data[Object.keys(data)[val]],
            }).appendTo(s1);
          }

          s1.appendTo("#actorDropDown");

          $("#actorSelector").change(function () {
            searchField = this.options[this.selectedIndex].text;
            console.log(searchField);
            generateActor(searchField)
          });
        }
      };
      xhttpB.open("GET", "http://localhost:5000/getTopActors", true);
      xhttpB.send();

    </script>


  </body>
</html>
